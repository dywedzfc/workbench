(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4755b85a"],{"11b8":function(t,e,a){"use strict";a("6fd5")},"1b3f":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dialog-drawer",class:{show:t.display,search:"search"==t.type,close:t.close}},[a("div",{staticClass:"dialog-drawer-header"},[a("div",{staticClass:"title"},[t._t("title",(function(){return[t._v(t._s(t.title))]}))],2),a("div",{staticClass:"button-close el-icon-close",on:{click:t.handleCloseClick}})]),a("div",{staticClass:"dialog-drawer-body"},[a("div",{ref:"flexWrapper",staticClass:"flex-wrapper"},[t._t("default")],2)])])},l=[],i={name:"DialogDrawer",props:{display:{type:Boolean,default:!1},title:String,type:String},data(){return{close:!1}},computed:{},watch:{display:{handler(t){t&&this.$refs["flexWrapper"].scrollTo(0,0)}}},mounted(){},destroyed(){this.close=!0},methods:{handleCloseClick(){this.$listeners["update:display"]&&this.$emit("update:display",!1)}}},r=i,n=(a("11b8"),a("2877")),o=Object(n["a"])(r,s,l,!1,null,"06cd7eb5",null);e["a"]=o.exports},6543:function(t,e,a){"use strict";a("6db9")},"6db9":function(t,e,a){},"6fd5":function(t,e,a){},b9e7:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page",{attrs:{title:t.tableFileItem.title+"表文件"},on:{back:t.handlePageBack}},[a("div",{staticClass:"template-wrapper"},[a("div",{staticClass:"textarea-box"},[a("el-input",{staticClass:"input-textarea",attrs:{type:"textarea",rows:8},model:{value:t.dataList,callback:function(e){t.dataList=e},expression:"dataList"}}),a("el-button",t._b({on:{click:t.handleGenerateClick}},"el-button",t.btnGenerateProps,!1),[t._v("生成字段")]),a("el-button",t._b({on:{click:t.handleSubmitClick}},"el-button",t.btnSaveProps,!1),[t._v("保存")]),a("el-button",t._b({on:{click:t.handleGenerateFileClick}},"el-button",t.btnHasDisableProps,!1),[t._v("生成文件")])],1),t.props.data.length?a("table",{staticClass:"table"},[a("colgroup",[a("col",{attrs:{width:"50"}}),a("col",{attrs:{width:"200"}}),a("col",{attrs:{width:"200"}}),a("col",{attrs:{width:"200"}}),a("col",{attrs:{width:"80"}})]),a("tr",[a("th",{staticClass:"table-header"}),a("th",{staticClass:"table-header"},[t._v("字段")]),a("th",{staticClass:"table-header"},[t._v("数据库名称")]),a("th",{staticClass:"table-header"},[t._v("默认值")]),a("th",{staticClass:"table-header"},[t._v("需要")]),a("th",{staticClass:"table-header"},[t._v("备注")])]),t._l(t.props.data,(function(e,s){return a("tr",{key:e.id,staticClass:"table-row"},[a("td",{staticClass:"table-del"},[a("el-button",{staticClass:"button-remove",attrs:{icon:"el-icon-remove"},on:{click:function(e){return t.headerRemoveRowClick(s)}}})],1),a("td",{staticClass:"table-data"},[a("el-input",{model:{value:e.name,callback:function(a){t.$set(e,"name",a)},expression:"item.name"}})],1),a("td",{staticClass:"table-data"},[a("el-input",{model:{value:e.sqlName,callback:function(a){t.$set(e,"sqlName",a)},expression:"item.sqlName"}})],1),a("td",{staticClass:"table-data"},[a("el-input",{model:{value:e.defaultValue,callback:function(a){t.$set(e,"defaultValue",a)},expression:"item.defaultValue"}})],1),a("td",{staticClass:"table-data table-data__need"},[a("el-switch",{model:{value:e.need,callback:function(a){t.$set(e,"need",a)},expression:"item.need"}})],1),a("td",{staticClass:"table-data"},[a("el-input",{model:{value:e.comment,callback:function(a){t.$set(e,"comment",a)},expression:"item.comment"}})],1)])}))],2):t._e()]),a("dialog-drawer",{attrs:{display:t.dialog.display,title:t.dialog.title},on:{"update:display":function(e){return t.$set(t.dialog,"display",e)}}},[a("el-form",{staticClass:"drawer-form left",attrs:{model:t.form}},[a("el-form-item",{attrs:{label:"json文件"}},[a("el-input",{attrs:{type:"textarea",rows:"19"},model:{value:t.form.data.jsonFile,callback:function(e){t.$set(t.form.data,"jsonFile",e)},expression:"form.data.jsonFile"}})],1)],1),a("el-form",{staticClass:"drawer-form right",attrs:{model:t.form}},[a("el-form-item",{attrs:{label:"js文件"}},[a("el-input",{attrs:{type:"textarea",rows:"19"},model:{value:t.form.data.jsFile,callback:function(e){t.$set(t.form.data,"jsFile",e)},expression:"form.data.jsFile"}})],1)],1),a("div",{staticClass:"drawer-form"},[a("el-button",[t._v("取消")]),a("el-button",{attrs:{type:"primary"}},[t._v("立即创建")])],1)],1)],1)},l=[],i=(a("d9e2"),a("2ef0")),r=a.n(i),n=a("2f62"),o=a("7651"),c=a("1b3f"),d=a("12db"),p=a("4260");window.require("fs");const u="import Props from '../base/props'\nimport { props } from './{configName}.config.json'\n\nclass {className} extends Props {\n  constructor(data) {\n    super(props)\n    this.initData(data)\n  }\n}\n\nexport default {className}\n";function m(t,e){try{const t=u;let a="",s="";e&&e.split("-").length&&r.a.forEach(e.split("-"),(t,e)=>{a+=0==e?t:r.a.capitalize(t),s+=r.a.capitalize(t)});let l=t;return l=l.replace(/{configName}/g,a),l=l.replace(/{className}/g,s),l}catch(a){console.info(a)}}var h={name:"ProjectFileEdit",components:{Page:o["a"],DialogDrawer:c["a"]},data(){return{dataList:"",dialog:{display:!1,title:""},form:{data:{jsonFile:"",jsFile:""}},props:{data:[],count:0},oldData:null}},computed:{...Object(n["b"])({projectItem:d["n"],tableFileItem:d["v"]}),queryButtonProps(){return{class:"button-query",type:"primary"}},btnGenerateProps(){const t=Object.assign({},this.queryButtonProps);return t.disabled=""==this.dataList,t},btnSaveProps(){const{data:t}=this.props,e=Object.assign({},this.btnHasDisableProps);if(!this.tableFileItem.data)return e;const a=JSON.stringify(t)==JSON.stringify(this.oldData);return e.disabled=e.disabled||a,e},btnHasDisableProps(){const t=Object.assign({},this.queryButtonProps);return t.disabled=0==this.props.data.length,t}},mounted(){},watch:{tableFileItem:{handler(t){"id"in t||this.$router.push({name:"项目文件"}),t.data&&Array.isArray(t.data)?(this.oldData=JSON.parse(JSON.stringify(t.data)),this.props.data=JSON.parse(JSON.stringify(t.data)),this.props.count=t.data.length):(this.props.data=[],this.props.count=0)},deep:!0,immediate:!0}},methods:{handlePageBack(){this.$router.push({name:"项目文件"})},handleGenerateClick(){try{const t=this.dataList.replace(/([a-zA-Z0-9\-_]{1,}):/g,'"$1":').replace(/'/g,'"'),e=JSON.parse(t);if(Array.isArray(e))r.a.each(e,t=>{r.a.each(t,(t,e)=>{if(this.props.data.length){const t=r.a.map(this.props.data,"sqlName").includes(e);if(t)return}this.props.data.push(this.initFieldItem({sqlName:e}))})});else{if("[object Object]"!==Object.prototype.toString.call(e))throw new TypeError("无法识别。");r.a.each(e,(t,e)=>{if(this.props.data.length){const t=r.a.map(this.props.data,"sqlName").includes(e);if(t)return}const a=this.initFieldItem({sqlName:e});this.props.data.push(a)})}}catch(t){const e=t.toString(),a=e.includes("SyntaxError")&&e.includes("JSON");a?Object(p["h"])("JSON格式不正确。"):"TypeError: 无法识别。"==t?Object(p["h"])("无法识别,不是JSON格式。"):console.error(t)}},handleGenerateFileClick(){this.setJSONFile(),this.setJSFile(),this.dialog.display=!0},handleSubmitClick(){const{data:t}=this.props;if(JSON.stringify(t)==JSON.stringify(this.tableFileItem.data))return;const e={...this.tableFileItem,data:t};Object(d["ib"])(e,{fileName:this.projectItem.fileName},({code:t})=>{200==t?(Object(p["g"])("添加成功"),this.oldData=JSON.parse(JSON.stringify(this.props.data))):Object(p["h"])("添加失败")})},headerRemoveRowClick(t){const e=this.props.data[t];this.$confirm(`此操作将永久删除"${e.sqlName}"数据, 是否继续?`,"提示",{type:"warning"}).then(()=>{this.$delete(this.props.data,t)}).catch(()=>{})},initFieldItem({sqlName:t,name:e,defaultValue:a,need:s,comment:l}={}){const i=/(-|_)([a-zA-Z])/g,r=(t,e,a)=>a.toUpperCase();return{id:++this.props.count,sqlName:t||"",name:e||t?t.replace(i,r):"",defaultValue:a||"",need:0!=s,comment:l||""}},setJSFile(){const{fileName:t}=this.tableFileItem,e=m("template",t);e.length&&(this.form.data.jsFile=e)},setJSONFile(){const t={props:{}};r.a.each(this.props.data,e=>{const a={name:e.name,sqlName:e.sqlName};e.defaultValue&&(a.defaultValue=e.defaultValue),0==e.need&&(a.need=e.need),e.comment&&(a.comment=e.comment),t.props[e.name]||(t.props[e.name]=a)});let e=JSON.stringify(t,null,2);this.form.data.jsonFile=e}}},b=h,f=(a("6543"),a("2877")),g=Object(f["a"])(b,s,l,!1,null,"5397e2c8",null);e["default"]=g.exports}}]);