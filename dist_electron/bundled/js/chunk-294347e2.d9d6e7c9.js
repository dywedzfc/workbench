(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-294347e2"],{"2e47":function(e,s,t){"use strict";t("f362")},ec5d:function(e,s,t){"use strict";t.r(s);var r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("page",{attrs:{title:"添加项目详情"},on:{back:e.handlePageBack}},[t("div",{staticClass:"template-wrapper"},[t("el-form",{staticClass:"panel-form",attrs:{inline:"","label-width":"90px"}},[t("el-form-item",{attrs:{label:"项目名称"}},[t("el-input",{staticClass:"input-block",model:{value:e.form.title,callback:function(s){e.$set(e.form,"title","string"===typeof s?s.trim():s)},expression:"form.title"}})],1),t("el-form-item",{attrs:{label:"项目简称"}},[t("el-input",{staticClass:"input-block",model:{value:e.form.abbreviation,callback:function(s){e.$set(e.form,"abbreviation",s)},expression:"form.abbreviation"}})],1),t("el-form-item",{attrs:{label:"文件名称"}},[t("el-input",{staticClass:"input-inline",model:{value:e.form.fileName,callback:function(s){e.$set(e.form,"fileName","string"===typeof s?s.trim():s)},expression:"form.fileName"}})],1),t("el-form-item",{attrs:{label:"项目类型"}},[t("el-input",{staticClass:"input-inline",model:{value:e.form.type,callback:function(s){e.$set(e.form,"type",s)},expression:"form.type"}})],1),t("el-form-item",{scopedSlots:e._u([{key:"label",fn:function(){return[t("span",[e._v("服务器地址")]),t("span",{staticClass:"input-label"},[e._v("说明")])]},proxy:!0}])},[t("div",{staticClass:"input-block"},[t("el-input",{staticClass:"input-block input-url",class:{error:e.error.serverAddress},on:{change:e.handleServerAddressChange},model:{value:e.form.serverAddress,callback:function(s){e.$set(e.form,"serverAddress",s)},expression:"form.serverAddress"}}),t("el-input",{staticClass:"input-block input-textarea",attrs:{type:"textarea",rows:"3"},model:{value:e.form.serverAddressMemo,callback:function(s){e.$set(e.form,"serverAddressMemo",s)},expression:"form.serverAddressMemo"}})],1)]),t("el-form-item",{scopedSlots:e._u([{key:"label",fn:function(){return[t("span",[e._v("本地地址")]),t("span",{staticClass:"input-label"},[e._v("说明")])]},proxy:!0}])},[t("div",{staticClass:"input-block"},[t("el-input",{staticClass:"input-block input-url",model:{value:e.form.localAddress,callback:function(s){e.$set(e.form,"localAddress",s)},expression:"form.localAddress"}}),t("el-input",{staticClass:"input-block input-textarea",attrs:{type:"textarea",rows:"2"},model:{value:e.form.localAddressMemo,callback:function(s){e.$set(e.form,"localAddressMemo",s)},expression:"form.localAddressMemo"}})],1)]),t("el-form-item",{scopedSlots:e._u([{key:"label",fn:function(){return[t("span",[e._v("SVN地址")]),t("span",{staticClass:"input-label"},[e._v("说明")])]},proxy:!0}])},[t("div",{staticClass:"input-block"},[t("el-input",{staticClass:"input-block input-url",class:{error:e.error.svnAddress},on:{change:e.handleSvnAddressChange},model:{value:e.form.svnAddress,callback:function(s){e.$set(e.form,"svnAddress",s)},expression:"form.svnAddress"}}),t("el-input",{staticClass:"input-block input-textarea",attrs:{type:"textarea",rows:"2"},model:{value:e.form.svnAddressMemo,callback:function(s){e.$set(e.form,"svnAddressMemo",s)},expression:"form.svnAddressMemo"}})],1)]),t("el-form-item",{scopedSlots:e._u([{key:"label",fn:function(){return[t("span",[e._v("API地址")]),t("span",{staticClass:"input-label"},[e._v("说明")])]},proxy:!0}])},[t("div",{staticClass:"input-block"},[t("el-input",{staticClass:"input-block input-url",class:{error:e.error.apiAddress},on:{change:e.handleApiAddressChange},model:{value:e.form.apiAddress,callback:function(s){e.$set(e.form,"apiAddress",s)},expression:"form.apiAddress"}}),t("el-input",{staticClass:"input-block input-textarea",attrs:{type:"textarea",rows:"2"},model:{value:e.form.apiAddressMemo,callback:function(s){e.$set(e.form,"apiAddressMemo",s)},expression:"form.apiAddressMemo"}})],1)]),t("el-form-item",{attrs:{label:"备注"}},[t("el-input",{staticClass:"input-block input-textarea",attrs:{type:"textarea",rows:"3"},model:{value:e.form.remark,callback:function(s){e.$set(e.form,"remark",s)},expression:"form.remark"}})],1),t("el-form-item",{attrs:{label:" "}},[t("el-button",{staticClass:"block",attrs:{type:"primary"},on:{click:e.handleSubmitClick}},[e._v("保存")])],1)],1)],1)])},a=[],i=(t("d9e2"),t("2ef0")),o=t.n(i),l=t("2f62"),n=t("7651"),d=t("12db"),c=t("4260");const{ipcRenderer:m}=window.require("electron");var p={name:"ProjectEdit",components:{Page:n["a"]},data(){return{update:!1,type:"",oldFileName:"",message:null,error:{serverAddress:!1,svnAddress:!1,apiAddress:!1},form:{title:"",abbreviation:"",fileName:"",serverAddress:"",serverAddressMemo:"",localAddress:"",localAddressMemo:"",svnAddress:"",svnAddressMemo:"",apiAddress:"",apiAddressMemo:"",remark:""}}},computed:{...Object(l["b"])({projectList:d["l"],projectItem:d["n"]})},watch:{projectItem:{handler(e){"id"in e||this.$router.push({name:"项目列表"}),this.form=e},deep:!0,immediate:!0}},mounted(){this.projectItem.fileName?(this.type="upd",this.oldFileName=this.projectItem.fileName):this.type="add"},methods:{requestSubmitProject(){Object(d["gb"])(this.form,({code:e,msg:s})=>{200==e?(Object(c["g"])(s),Object(d["J"])(),this.update=!0,this.oldFileName=this.form.fileName,this.$router.push("/jkzsl/list")):Object(c["h"])(s)})},handlePageBack(){this.update||Object(d["J"])(),this.$router.push({name:"项目列表"})},handleServerAddressChange(e){const s=Object(c["k"])(e);e?s?this.error.serverAddress=!1:(this.message=Object(c["h"])("服务器地址格式不正确！"),this.error.serverAddress=!0):this.error.serverAddress=!1},handleSvnAddressChange(e){const s=Object(c["k"])(e);e?s?this.error.svnAddress=!1:(this.message=Object(c["h"])("SVN地址格式不正确！"),this.error.svnAddress=!0):this.error.svnAddress=!1},handleApiAddressChange(e){const s=Object(c["k"])(e);e?s?this.error.apiAddress=!1:(this.message=Object(c["h"])("API地址格式不正确！"),this.error.apiAddress=!0):this.error.apiAddress=!1},handleSubmitClick(){if(this.verificationProjectForm())return;const{title:e}=this.form,s=o.a.filter(this.projectList,s=>s.title==e).length;s>1?Object(c["f"])("项目名称已重复，是否修改？").then(this.hasRepeatFolder).catch(()=>{}):this.hasRepeatFolder()},verificationProjectForm(){const{title:e,fileName:s,serverAddress:t,svnAddress:r,apiAddress:a}=this.form;if(this.message&&this.message.close(),!e)return Object(c["h"])("请输入项目名称"),!0;if(!s)return Object(c["h"])("请输入文件名称"),!0;const i=o.a.filter(this.projectList,e=>e.fileName==s).length;return i>1?(Object(c["h"])("文件名已重复，无法添加！"),!0):t&&!Object(c["k"])(t)?(this.error.serverAddress=!0,Object(c["h"])("服务器地址格式不正确！"),!0):r&&!Object(c["k"])(r)?(this.error.svnAddress=!0,Object(c["h"])("SVN地址格式不正确！"),!0):!(!a||Object(c["k"])(a))&&(this.error.apiAddress=!0,Object(c["h"])("API地址格式不正确！"),!0)},hasRepeatFolder(){const{fileName:e}=this.form;m.invoke("has-repeat-folder",{fileName:e}).then(async s=>{"add"==this.type&&300==s.code?this.requestSubmitProject():"upd"==this.type?this.oldFileName!=e?300==s.code?this.resetFileName():301==s.code&&Object(c["h"])("文件夹已存在，无法修改！"):this.requestSubmitProject():"add"==this.type?Object(c["h"])("文件夹已存在，无法添加！"):Object(c["h"])("文件夹已存在，无法修改！")})},async resetFileName(){try{const e={oldPath:this.oldFileName,newPath:this.form.fileName},{code:s}=await m.invoke("rename",e);if(400==s)throw new Error("替换失败");this.requestSubmitProject()}catch(e){console.error(e)}}}},u=p,f=(t("2e47"),t("2877")),h=Object(f["a"])(u,r,a,!1,null,"75d24afe",null);s["default"]=h.exports},f362:function(e,s,t){}}]);